
@{
    ViewBag.Title = "CoD";
    Layout = "~/Views/Shared/_LayoutUser.cshtml";
}

<div ng-app="myApp" ng-controller="myCtrl">
    <!-- top tiles -->
    <div class="row tile_count">
        <div class="col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> Số tiền COD</span>
            <div class="count">{{ sumCoD}}</div>
        </div>
        <div class="col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> Số COD đang phát</span>
            <div class="count">{{ sumCODDangPhat}}</div>
        </div>
        <div class="col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> Số COD chuyển hoàn</span>
            <div class="count">{{ sumCODChuyenHoan}}</div>
        </div>
    </div>
    <!-- /top tiles -->

    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Thông tin thanh toán CoD</h2>

                    <div class="clearfix"></div>
                </div>
                <div class="x_content">

                    <div class="" role="tabpanel" data-example-id="togglable-tabs">
                        <ul class="nav nav-tabs bar_tabs" role="tablist">
                            <li role="presentation" class="active">
                                <a href="#tab_phieuthu" role="tab" data-toggle="tab" aria-expanded="false" ng-click="tabcreate = false">Phiếu thanh toán</a>
                            </li>
                            <li role="presentation">
                                <a href="#tab_chitiet" role="tab" data-toggle="tab" aria-expanded="false" ng-click="tabcreate = false">Chi tiết</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active in" id="tab_phieuthu" aria-labelledby="home-tab">
                                <form name="formSearch" ng-submit="GetData()">
                                    <div class="col-sm-4">
                                        <div class="form-group">
                                            <label>Thời gian (từ ngày => đến ngày)</label>
                                            <div class="row">
                                                <div class="col-sm-5">
                                                    <input type="text" required class="form-control" ui-mask='99/99/9999' model-view-value="true" ui-mask-placeholder ui-mask-placeholder-char="" ng-model="searchInfo.fromDate">
                                                </div>
                                                <div class="col-sm-5">
                                                    <input type="text" required class="form-control" ui-mask='99/99/9999' model-view-value="true" ui-mask-placeholder ui-mask-placeholder-char="" ng-model="searchInfo.toDate">
                                                </div>
                                                <div class="col-sm-2">
                                                    <button class="btn btn-primary" type="submit">Xem thông tin</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="table-responsive">
                                            <table class="table table-striped jambo_table bulk_action">
                                                <thead>
                                                    <tr class="headings">
                                                        <th>STT</th>
                                                        <th>Tgian</th>
                                                        <th>Số tiền</th>
                                                        <th>Số đơn</th>
                                                        <th>Tình trạng</th>
                                                        <th>Số hóa đơn</th>
                                                        <th>Ghi chú</th>
                                                    </tr>
                                                </thead>

                                                <tbody>
                                                    <tr ng-repeat="item in documents">
                                                        <td>{{$index + 1}} <a href="#" class="label label-primary" ng-click="showDetails($index)">chi tiết</a></td>
                                                        <td>
                                                            {{item.DocumentDate}} <br />
                                                            {{item.DocumentTime}}
                                                        </td>
                                                        <td>{{item.AllMoney | currency:'VND'}}</td>
                                                        <td>{{item.AllMailer}}</td>
                                                        <td><h4><span ng-class="{'label label-primary' : item.StatusID === 2, 'label label-danger': item.StatusID === 1 || item.StatusID === 0}">{{status[item.StatusID].name}}</span></h4></td>
                                                        <td>{{item.InvoiceCode}}</td>
                                                        <td>{{item.Notes}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <!--phan trang-->
                                        <ul items-per-page="itemPerPage" uib-pagination total-items="totalItems" ng-model="currentPage" ng-change="pageChanged()" max-size="maxSize" boundary-link-numbers="true" rotate="false" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></ul>
                                        <!-- end phan trang-->
                                    </div>
                                </div>
                            </div>

                            <div role="tabpanel" class="tab-pane fade" id="tab_chitiet" aria-labelledby="profile-tab">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <h4><strong>Tổng tiền: </strong> {{document.AllMoney | currency:'VND'}}</h4>
                                        <h4><strong> Số hóa đơn: </strong> {{document.InvoiceCode}}</h4>
                                        <h4><strong> Tình trạng: </strong> <span ng-class="{'label label-primary' : document.StatusID === 2, 'label label-danger': document.StatusID === 1 || document.StatusID === 0}">{{status[document.StatusID].name}}</span></h4>
                                    </div>
                                    <div class="col-sm-3">
                                        <h4><strong>Tổng đơn: </strong> {{document.AllMailer}}</h4>
                                        <h4><strong>Ghi chú: </strong> {{document.Notes}}</h4>
                                    </div>

                                    <div class="col-sm-12">
                                        <div class="table-responsive">
                                            <table class="table table-striped jambo_table bulk_action">
                                                <thead>
                                                    <tr class="headings">
                                                        <th>STT</th>
                                                        <th>Mã đơn</th>
                                                        <th>CoD</th>
                                                        <th>Thông tin phát</th>
                                                    </tr>
                                                </thead>

                                                <tbody>
                                                    <tr ng-repeat="item in details">
                                                        <td>{{$index + 1}}</td>
                                                        <td>{{item.MailerID}}&nbsp;<a href="/donhang/chitiet/{{item.MailerID}}" target="_blank">xem</a></td>
                                                        <td>{{item.COD | currency: 'VND'}}</td>
                                                        <td>
                                                            <strong>Ngày phát: </strong> {{item.DeliveryDate}} <br />
                                                            <strong>Giờ phát: </strong> {{item.DeliveryTime}} <br />
                                                            <strong>Ký nhận: </strong> {{item.DeliveryTo}}
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>


                </div>
            </div>
        </div>

    </div>
</div>


@section scripts {

    <script type="text/javascript">
          var info = '@ViewBag.InfoID';
        var currentDate = '@DateTime.Now.ToString("dd/MM/yyyy")';
        var fromDate = '@DateTime.Now.AddDays(-7).ToString("dd/MM/yyyy")';
        var toDate = '@DateTime.Now.AddDays(1).ToString("dd/MM/yyyy")';
    </script>

    <script src="~/Scripts/showcod.js"></script>
}